{"version":3,"file":"useElementBackground.js","sources":["../../../../../src/composables/useElementBackground/useElementBackground.ts"],"sourcesContent":["import { useDomChangesObserver } from './useDomChangesObserver'\nimport { getElementBackground } from './utils'\nimport { ref, Ref, onMounted } from 'vue'\nimport { applyColors, useColors } from '../useColors'\nimport { useEl } from '../useEl'\n\ntype Maybe<T> = T | null | undefined\n\nconst isTransparent = (color: string) => color === 'rgba(0, 0, 0, 0)'\n\nconst recursiveGetBackground = (element: Maybe<HTMLElement>): string => {\n  if (!element) { return '#fff' } // Likely doesn't have a color, so let's just return white\n  if (element.nodeType !== Node.ELEMENT_NODE) { return recursiveGetBackground(element.parentElement) }\n\n  const bg = getElementBackground(element)\n\n  if (!bg) { return recursiveGetBackground(element.parentElement) }\n\n  if (isTransparent(bg)) {\n    const parentBg = recursiveGetBackground(element.parentElement)\n    return parentBg\n  }\n\n  return applyColors(recursiveGetBackground(element.parentElement), bg)\n}\n\n/** Can be null before component is mounted */\nexport const useElementBackground = (element?: Ref<HTMLElement | undefined>) => {\n  const el = element || useEl()\n  const { getColor } = useColors()\n  const background = ref(getColor('background-primary'))\n\n  const updateBackground = () => {\n    requestAnimationFrame(() => {\n      const bg = recursiveGetBackground(el.value)\n      background.value = bg\n    })\n  }\n\n  useDomChangesObserver(updateBackground, el)\n\n  onMounted(updateBackground)\n\n  return {\n    background,\n  }\n}\n"],"names":[],"mappings":";;;;;;AAQA,MAAM,gBAAgB,CAAC,UAAkB,UAAU;AAEnD,MAAM,yBAAyB,CAAC,YAAwC;AACtE,MAAI,CAAC,SAAS;AAAS,WAAA;AAAA,EAAO;AAC1B,MAAA,QAAQ,aAAa,KAAK,cAAc;AAAS,WAAA,uBAAuB,QAAQ,aAAa;AAAA,EAAE;AAE7F,QAAA,KAAK,qBAAqB,OAAO;AAEvC,MAAI,CAAC,IAAI;AAAS,WAAA,uBAAuB,QAAQ,aAAa;AAAA,EAAE;AAE5D,MAAA,cAAc,EAAE,GAAG;AACf,UAAA,WAAW,uBAAuB,QAAQ,aAAa;AACtD,WAAA;AAAA,EACT;AAEA,SAAO,YAAY,uBAAuB,QAAQ,aAAa,GAAG,EAAE;AACtE;AAGa,MAAA,uBAAuB,CAAC,YAA2C;AACxE,QAAA,KAAK,WAAW;AAChB,QAAA,EAAE,aAAa;AACrB,QAAM,aAAa,IAAI,SAAS,oBAAoB,CAAC;AAErD,QAAM,mBAAmB,MAAM;AAC7B,0BAAsB,MAAM;AACpB,YAAA,KAAK,uBAAuB,GAAG,KAAK;AAC1C,iBAAW,QAAQ;AAAA,IAAA,CACpB;AAAA,EAAA;AAGH,wBAAsB,kBAAkB,EAAE;AAE1C,YAAU,gBAAgB;AAEnB,SAAA;AAAA,IACL;AAAA,EAAA;AAEJ;;"}